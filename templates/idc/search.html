{% extends 'base.html' %}
{% load staticfiles %}

{% comment %}

   Copyright 2015, Institute for Systems Biology

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

{% endcomment %}

{% block header %}

    <script type="text/javascript"  src="{% static 'js/sample_cohort.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/image_search.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/libs/plotly-latest.min.js' %}"></script>
    <link type="text/css" rel="stylesheet" href="{% static 'css/style.css' %}">
    <link type="text/css" rel="stylesheet" href="{% static 'css/vendor.css' %}">
    <link type="text/css" rel="stylesheet" href="{% static 'css/bootstrap.css' %}">

    <script>
    function mkSlider(divName,inpName, field) {
        $("#" + divName).slider({
            values: [0, 120],
            step: 1,
            min: 0,
            max: 120,
            slide: function (event, ui) {
                $("#" + inpName).val(ui.values[0] + "-" + ui.values[1]);
            },
            stop: function (event, ui) {
                   filterObj[field]=[parseFloat(ui.values[0]),parseFloat(ui.values[0])]
            }
        });
    }
    </script>


  <style>
       th, tb,tr,td {border: 1px solid black;}
       tr.selected_grey td {background-color: #333; color: #fff;}
       /* thead, tbody { display: block; } */

    tbody.set_height {
          max-height: 200px;       /* Just for the demo          */
          overflow-y: scroll;    /* Trigger vertical scroll    */
         overflow-x: hidden;  /* Hide the horizontal scroll */
        width:100%;
        display:inline-block;

        table-layout: fixed;




        }
  thead {

display: table;
      width: calc( 100% - 1em )
}

      th{
          width:25%;
          word-wrap: break-word;
      }

      td{
          width:25%;
           word-break: break-word;

      }


  table{
      table-layout:fixed;

      width: 100%;



  }

    </style>

    <script>

    window.onload = function(){
        fetchCountData(true);
       // mkSlider("age_slide", "inp_age_slide", "inp_age_stop", 0, 120, 120)

        //mkSlider("slider-1","slider-inp");
    }
    </script>




{% endblock %}

{% block link_page_name %}help{% endblock %}
{% block page_name %}help{% endblock %}

{% block content %}



<div class="container" style="display:block">
    <div class ="row">
        <div class="col-lg-12">
            <div class="tab-pane data-tab" role="tabpanel">
                 <div class="col-lg-4 filter-panel" role="tabpanel">
                     <div class="row">
                        <h3>Search Scope:</h3>
                         <select id="project_scope" onchange="updateSearchScope(this)">
                             <option value="All" >All data</option>
                          </select>
                       <!--   <div id = "slider-1"></div>
                         <input id="slider-inp" type="text" value="120"> -->
                     </div>


                  <div class="row">
                    <h3>Search Configuration:</h3>
                   <div class="tab-panel" role="tabpanel">
         
                 <ul class="nav nav-tabs nav-tabs-filters" role="tablist">
                    <li id = "search_orig" role="presentation" class="filter-tab active"><a href="#search_orig_set" role="tab" data-toggle="tab" title="orig" aria-expanded="true">Original</a></li>
                    <li id = "search_derived" role="presentation" class="filter-tab"><a href="#search_derived_set" role="tab" data-toggle="tab" title="derived" aria-expanded="false"">Derived</a></li>
                    <li id = "search_related" role="presentation" class="filter-tab"><a href="#search_related_set" role="tab" data-toggle="tab" title="related" aria-expanded="false">Related</a></li>
                 </ul>


             <div class="tab-content">
                  <div id = "search_orig_set" role="tabpanel" class="tab-pane active">
                    <div id="modality_heading">
                       <a role="button" data-toggle="collapse"  href="#modality" aria-expanded="false" aria-controls="modality">
                     <i class="fa fa-caret-right"></i> Modality</a>
                   </div>
                   <div id="modality" class="collapse">
                   <ul style="list-style: none;">
                       <li>&emsp;<input type="checkbox" checked value="CT" onclick="updateFilterSelection('modality', 'modality_set','Modality','Modality',true,false)">Computed Tomography(CT)</li>
                       <li>&emsp;<input type="checkbox" checked value="CTPT" onclick="updateFilterSelection('modality', 'modality_set','Modality','Modality',true,false)">??(CTPT)</li>
                        <li>&emsp;<input type="checkbox" checked value="CR" onclick="updateFilterSelection('modality', 'modality_set','Modality','Modality',true,false)">Computed Radiology(CR)</li>
                        <li>&emsp;<input type="checkbox" checked value="MR" onclick="updateFilterSelection('modality', 'modality_set','Modality','Modality',true,false)">Magnetic Resonance(MR)</li>
                        <li>&emsp;<input type="checkbox" checked value="MG" onclick="updateFilterSelection('modality', 'modality_set','Modality','Modality',true,false)">Mamography(MG)</li>
                    <li>&emsp;<input type="checkbox" checked value="NM" onclick="updateFilterSelection('modality', 'modality_set','Modality','Modality',true,false)">Nuclear Medicine(NM)</li>
                    <li>&emsp;<input type="checkbox" checked value="RTPLAN" onclick="updateFilterSelection('modality', 'modality_set','Modality','Modality',true,false)">Radiotherapy Plan(RTPLAN)</li>
                    <li>&emsp;<input type="checkbox" checked value="RTSTRUCT" onclick="updateFilterSelection('modality', 'modality_set','Modality','Modality',true,false)">Radiotheraoy Structure Set(RTSTRUCT)</li>

                 </ul>
                </div>

                <div id="body_heading">
                    <a role="button" data-toggle="collapse"  href="#body_part" aria-expanded="true" aria-controls="body_part" class="">
                   <i class="fa fa-caret-right"></i> Body Part Examined
                    </a>
                </div>

                <div id="body_part" class="collapse">
                    <ul style="list-style: none;">
                    <li>&emsp;<input type="checkbox" checked value="BLADDER" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Bladder</li>
                    <li>&emsp;<input type="checkbox" checked value="BRAIN" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Brain </li>
                        <li>&emsp;<input type="checkbox" checked value="CHEST" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Chest</li>
                    <li>&emsp;<input type="checkbox" checked value="COLON" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Colon</li>
                    <li>&emsp;<input type="checkbox" checked value="HEADNECK" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Head/Neck</li>
                        <li>&emsp;<input type="checkbox" checked value="KIDNEY" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Kidney</li>
                    <li>&emsp;<input type="checkbox" checked value="PROSTATE" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Prostate</li>
                        <li>&emsp;<input type="checkbox" checked value="STOMACH" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Stomach</li>
                    <li>&emsp;<input type="checkbox" checked value="THYROID" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Thyroid</li>
                    <li>&emsp;<input type="checkbox" checked value="None" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Not Available/Other</li>


                   </ul>
                </div>
            </div>



            <div id = "search_derived_set" role="tabpanel" class="tab-pane">
               <div id="segmentation_heading">
                    <a role="button" data-toggle="collapse"  href="#segmentation" aria-expanded="false" aria-controls="segmentation" class="">
                   <i class="fa fa-caret-right"></i> Segmentation</a>
                </div>
                <div id="segmentation" class="collapse">
                    <ul style="list-style: none;">
                        <li>&emsp;<input type="checkbox" checked value="yes">&emsp;Segmentation Available</li>
                        <li>&emsp;<input type="checkbox" checked value="no">&emsp;Segmentation Not Available</li>
                    </ul>
                </div>

            </div>

            <div id = "search_related_set" role="tabpanel" class="tab-pane">
                <div id="disease_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#disease" aria-expanded="false" aria-controls="disease">
                        <i class="fa fa-caret-right"></i> Disease Code</a>
                </div>

                <div id="disease" class="collapse">
                    <ul id="disease_list" style="list-style: none;">


                    </ul>
                </div>


                <div id="vital_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#vital_status" aria-expanded="false" aria-controls="vital_status">
                        <i class="fa fa-caret-right"></i> Vital Status</a>
                </div>

                <div id="vital_status" class="collapse">
                    <ul id="vital_list" style="list-style: none;">
                         <li>&emsp;<input type="checkbox" checked value="Alive" onclick="updateFilterSelection('vital_list', 'vital_status_set','Vital Status','vital_status',false,false)">Alive</li>
                        <li>&emsp;<input type="checkbox" checked value="Dead" onclick="updateFilterSelection('vital_list', 'vital_status_set','Vital Status','vital_status',false,false)">Dead</li>
                        <li>&emsp;<input type="checkbox" checked value="None" onclick="updateFilterSelection('vital_list', 'vital_status_set','Vital Status','vital_status',false,false)">NA</li>
                    </ul>
                </div>

                <div id="gender_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#gender" aria-expanded="false" aria-controls="vital">
                        <i class="fa fa-caret-right"></i>Gender</a>
                </div>

                <div id="gender" class="collapse">
                    <ul id="gender_list" style="list-style: none;">
                         <li>&emsp;<input type="checkbox" checked value="MALE" onclick="updateFilterSelection('gender_list', 'gender_set','Gender','gender',false,false)">Male</li>
                        <li>&emsp;<input type="checkbox" checked value="FEMALE" onclick="updateFilterSelection('gender_list', 'gender_set','Gender','gender',false,false)">Female</li>
                        <li>&emsp;<input type="checkbox" checked value="None" onclick="updateFilterSelection('gender_list', 'gender_set','Gender','gender',false,false)">NA</li>
                    </ul>
                </div>

               <div id="age_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#age" aria-expanded="false" aria-controls="age">
                        <i class="fa fa-caret-right"></i>Age</a>
                </div>

                <div id="age" class="collapse">

                    <div id="age_slide"></div>
                        <input id="inp_age_slide">0-120</input>
                      <input id="inp_age_stop">0-120</input>



                    <ul id="age_list" style="list-style: none;">
                         <li>&emsp;<input type="checkbox" checked value="0 to 20" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">0-19</li>
                        <li>&emsp;<input type="checkbox" checked value="20 to 30" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">20-29</li>
                        <li>&emsp;<input type="checkbox" checked value="30 to 40" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">30-39</li>
                        <li>&emsp;<input type="checkbox" checked value="40 to 50" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">40-49</li>
                        <li>&emsp;<input type="checkbox" checked value="50 to 60" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">50-59</li>
                        <li>&emsp;<input type="checkbox" checked value="60 to 70" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">60-69</li>
                        <li>&emsp;<input type="checkbox" checked value="70 to 80" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">70-79</li>
                        <li>&emsp;<input type="checkbox" checked value="80 to 200" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">80 or Over</li>
                        <li>&emsp;<input type="checkbox" checked value="None" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">NA</li>
                    </ul>
                </div>

                <div id="bmi_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#bmi" aria-expanded="false" aria-controls="bmi">
                        <i class="fa fa-caret-right"></i>BMI</a>
                </div>

                <div id="bmi" class="collapse">
                    <ul id="bmi_list" style="list-style: none;">
                         <li>&emsp;<input type="checkbox" checked value="0 to 18.5" onclick="updateFilterSelection('bmi_list', 'bmi_set','BMI','bmi',false,true)">Underweight: BMI less than 18.5</li>
                        <li>&emsp;<input type="checkbox" checked value="18.5 to 25" onclick="updateFilterSelection('bmi_list', 'bmi_set','BMI','bmi',false,true)">Normal weight: BMI greater than or equal to 18.5 and less than 25</li>
                        <li>&emsp;<input type="checkbox" checked value="25 to 30" onclick="updateFilterSelection('bmi_list', 'bmi_set','BMI','bmi',false,true)">Overweight: BMI greater than 25 and less than 30</li>
                        <li>&emsp;<input type="checkbox" checked value="30 to 100" onclick="updateFilterSelection('bmi_list', 'bmi_set','BMI','bmi',false,true)">Obese: BMI greater than 30</li>

                        <li>&emsp;<input type="checkbox" checked value="None">NA</li>
                    </ul>
                </div>

                <div id="race_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#race" aria-expanded="false" aria-controls="race">
                        <i class="fa fa-caret-right"></i>Race</a>
                </div>

                <div id="race" class="collapse">
                    <ul id="race_list" style="list-style: none;">
                    </ul>
                </div>

               <div id="ethnicity_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#ethnicity" aria-expanded="false" aria-controls="ethnicity">
                        <i class="fa fa-caret-right"></i>Ethnicity</a>
                </div>

                <div id="ethnicity" class="collapse">
                    <ul id="ethnicity_list" style="list-style: none;">

                    </ul>
                </div>



            </div>


           </div>
         </div>
        </div>
        </div>
                 <div class="col-lg-8 filter-panel" role="tabpanel">
                     <div class="row">
                     <h3>Search Definition:</h3>
                      <ul>
                         <li id="qproj"><h4>Project: <text id="selected_project">All</text></h4></li>
                         <li>Original:</li>
                              <ul>
                                <li id="modality_set">&emsp;&emsp;Modality: All</li>
                                <li id="body_part_examined_set">&emsp;&emsp;Body Part Examined: All</li>
                                </ul>
                          <li>Derived:</li>
                          <li>Related:</li>
                               <ul>
                                   <li id="disease_code_set">&emsp;&emsp;Disease Code: All</li>
                                   <li id="vital_status_set">&emsp;&emsp;Vital Status: All</li>
                                   <li id="gender_set">&emsp;&emsp;Gender: All</li>
                                   <li id="age_set">&emsp;&emsp;Age: All</li>
                                   <li id="bmi_set">&emsp;&emsp;BMI: All</li>
                                   <li id="race_set">&emsp;&emsp;Race: All</li>
                                  <li id="ethnicity_set">&emsp;&emsp;Ethnicity: All</li>
                                </ul>
                       </ul>
                       </div>
                     <div class="row">
                       <h3>Search Results:</h3>
                        <div class="tab-panel" role="tabpanel">
                             <ul class="nav nav-tabs nav-tabs-filters" role="tablist">
                                 <li id = "results_orig" role="presentation" class="filter-tab active"><a href="#results_orig_set" role="tab" data-toggle="tab" title="orig" aria-expanded="true">Original</a></li>
                                 <li id = "results_derived" role="presentation" class="filter-tab"><a href="#results_derived_set" role="tab" data-toggle="tab" title="derived" aria-expanded="false"">Derived</a></li>
                                <li id = "results_related" role="presentation" class="filter-tab"><a href="#results_related_set" role="tab" data-toggle="tab" title="related" aria-expanded="false">Related</a></li>
                              </ul>
                         </div>
                         <div class="tab-content">
                           <div id = "results_orig_set" role="tabpanel" class="tab-pane active">
                                  <div id="modality_chart" style="float:left;float:top display:inline-block;width:300px;height:200px" ></div>
                                  <div id="body_part_examined_chart" style="float:left;float:top display:inline-block;width:300px;height:300px"></div>

                           </div>
                             <div id = "results_derived_set" role="tabpanel" class="tab-pane">
                           </div>
                             <div id = "results_related_set" role="tabpanel" class="tab-pane">
                                 <div id="disease_code_chart" style="float:left;float:top display:inline-block;width:300px;height:200px"></div>
                                 <div id="vital_status_chart" style="float:left;float:top display:inline-block;width:300px;height:200px" ></div>
                                 <div id="gender_chart" style="float:left;float:top display:inline-block;width:300px;height:200px"></div>
                                <div id="age_chart" style="float:left;float:top display:inline-block;width:300px;height:200px"></div>
                           <!-- <div id="bmi_chart" style="float:left;float:top display:inline-block;width:300px;height:200px"></div> -->

                                <div id="race_chart" style="float:left;float:top display:inline-block;width:300px;height:200px"></div>
                                 <div id="ethnicity_chart" style="float:left;float:top display:inline-block;width:300px;height:200px"></div>




                                 </div>
                         </div>
                  </div>
                     <div class="row">
                         <table id="projects_table">
                             <tr>
                                <th><th>Project Name</th><th>Total # of Patients</th><th># of Patients(this cohort)</th>
                             </tr>
                          </table>
                          <br><br>
                          <table >
                              <thead>
                             <tr>
                                 <th >Project Name </th><th >Patient Id</th><th>Study Id</th><th>Study Description</th>
                             </tr>
                              </thead>


                             <tbody  id="studies_table" class="set_height">

                              </tbody>

                          </table >
                          <br><br>
                          <table>
                             <thead>
                              <tr>
                                <th>Study Id</th><th>Series Id</th><th>Modality</th><th>Body Part Examined</th>
                              </tr>
                              </thead>

                              <tbody id="series_table" class="set_height">

                              </tbody>
                          </table>
                     </div>
            </div>
        </div>
    </div>

</div>




{% endblock %}

{% block js_file %}{% static 'js/dashboard.js' %}{% endblock %}