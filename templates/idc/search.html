{% extends 'base.html' %}
{% load staticfiles %}

{% comment %}

   Copyright 2015, Institute for Systems Biology

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

{% endcomment %}

{% block header %}
    <!-- <script type="text/javascript" src="https://requirejs.org/docs/release/2.3.6/comments/require.js"></script> -->
    <!-- <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script type="text/javascript" src="/static/js/sample_cohort.js"></script>
    <script type="text/javascript" src="/static/js/image_search.js"></script>
    <script type="text/javascript" src="/static/js/plotly-latest.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <style>
        .iframe-container {
       overflow: hidden;
       // Calculated from the aspect ration of the content (in case of 16:9 it is 9/16= 0.5625)
       padding-top: 56.25%;
       position: relative;
       }

      .iframe-container iframe {
       border: 0;
       height: 100px;
        left: 0;
        position: absolute;
        top: 0;
         width: 100%;
      }

    </style>
    <script>
    cohortObj=new Object();


    window.onload = function(){

        constructProjects();
        updateSelections(-1,[]);
        //resolveRelateDataPlotsCat("disease", "disease_code_chart","disease_code");
resolveAllPlots()
      //  updateAllFilterSelections();
        //$('#viewId').load('http://localhost:8085/viewer/1.3.6.1.4.1.14519.5.2.1.6279.6001.265704884949271879044145982159');

        //window.alert("some text");
        //await new Promise(r => setTimeout(r, 5000));
        //document.getElementById("srcU").scrollTo(200,200);
       // document.getElementById('srcU').contentWindow.scrollTo(2000,400);
        //window.alert(len.toString());
        //window.scrollTo(200,200);

    }
    </script>

{% endblock %}

{% block link_page_name %}help{% endblock %}
{% block page_name %}help{% endblock %}

{% block content %}
    tmp
{{ request.session.name }}
    tmp
    <div class="col-lg-12" style="float:left;width:51%">

        <p><h3>Search Scope:</h3>
        <select id="data_scope">
        <option value="all">All data</option>
        </select>
        tmp {{ request.session.TEST_COOKIE_NAME }}
    </p>

    </div>

    <div class="col-lg-12" style="float:left;width:49%;border: thin solid black;">

        <p><h3>Search Definition:</h3>
            <ul>
                <li id="qproj"><h4>Project: All</h4></li>
           <li>Original:</li>
                <ul>
                    <li id="modality_set">&emsp;&emsp;Modality: All</li>
                    <li id="body_part_examined_set">&emsp;&emsp;Body Part Examined: All</li>
                </ul>
           <li>Derived:</li>
           <li>Related:</li>
                <ul>
                    <li id="disease_code_set">&emsp;&emsp;Disease Code: All</li>
                    <li id="vital_status_set">&emsp;&emsp;Vital Status: All</li>
                    <li id="gender_set">&emsp;&emsp;Gender: All</li>
                    <li id="age_set">&emsp;&emsp;Age: All</li>
                    <li id="bmi_set">&emsp;&emsp;BMI: All</li>
                    <li id="race_set">&emsp;&emsp;Race: All</li>
                    <li id="ethnicity_set">&emsp;&emsp;Ethnicity: All</li>
                </ul>
           </ul>

    </p>

    </div>


    <div class="col-lg-12" style="float:left;width:50%">



        <div style="width:100%"><h3>Search Configuration</h3></div>
        <div id = "search_orig" style="display:inline-block;width:32%;border: thin solid black;background-color:dodgerblue" onclick="toggleSearch(0,'search')"><h3>Original</h3></div>
        <div id = "search_derived" style="display:inline-block;width:32%;border: thin solid black" onclick="toggleSearch(1,'search')"><h3>Derived</h3></div>
        <div id = "search_related" style="display:inline-block;width:32%;border: thin solid black" onclick="toggleSearch(2,'search')"><h3>Related</h3></div>

        <div align="left"; style="width:97%;display:inline-block;border: thin solid black;float:none">
            <div id = "search_orig_set" align="left" style="display:inline-block;">
                <div id="modality_heading">
                    <a role="button" data-toggle="collapse"  href="#modality" aria-expanded="false" aria-controls="modality">
                   <i class="fa fa-caret-right"></i> Modality</a>
                </div>
               <div id="modality" class="collapse">
                <ul style="list-style: none;">
                <li>&emsp;<input type="checkbox" checked value="ct" onclick="updateFilterSelection('modality', 'modality_set','Modality','Modality',0,false)">Computed Tomography(CT)</li>
                    <li>&emsp;<input type="checkbox" checked value="ctpt" onclick="updateFilterSelection('modality', 'modality_set','Modality',0,false)">??(CTPT)</li>
                    <li>&emsp;<input type="checkbox" checked value="cr" onclick="updateFilterSelection('modality', 'modality_set','Modality',0,false)">Computed Radiology(CR)</li>
                <li>&emsp;<input type="checkbox" checked value="mr" onclick="updateFilterSelection('modality', 'modality_set','Modality',0,false)">Magnetic Resonance(MR)</li>
                    <li>&emsp;<input type="checkbox" checked value="mg" onclick="updateFilterSelection('modality', 'modality_set','Modality',0,false)">Mamography(MG)</li>
                    <li>&emsp;<input type="checkbox" checked value="nm" onclick="updateFilterSelection('modality', 'modality_set','Modality',0,false)">Nuclear Medicine(NM)</li>
                    <li>&emsp;<input type="checkbox" checked value="rtplan" onclick="updateFilterSelection('modality', 'modality_set','Modality',0,false)">Radiotherapy Plan(RTPLAN)</li>
                    <li>&emsp;<input type="checkbox" checked value="rtstruct" onclick="updateFilterSelection('modality', 'modality_set','Modality',0,false)">Radiotheraoy Structure Set(RTSTRUCT)</li>

                 </ul>
                </div>

                <div id="body_heading">
                    <a role="button" data-toggle="collapse"  href="#body_part" aria-expanded="true" aria-controls="body_part" class="">
                   <i class="fa fa-caret-right"></i> Body Part Examined
                    </a>
                </div>

                <div id="body_part" class="collapse">
                    <ul style="list-style: none;">
                    <li>&emsp;<input type="checkbox" checked value="bladder" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Bladder</li>
                    <li>&emsp;<input type="checkbox" checked value="brain" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Brain </li>
                    <li>&emsp;<input type="checkbox" checked value="colon" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Colon</li>
                    <li>&emsp;<input type="checkbox" checked value="headneck" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Head/Neck</li>
                        <li>&emsp;<input type="checkbox" checked value="kidney" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Kidney</li>
                    <li>&emsp;<input type="checkbox" checked value="prostate" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Prostate</li>
                    <li>&emsp;<input type="checkbox" checked value="thyroid" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Thyroid</li>
                    <li>&emsp;<input type="checkbox" checked value="none" onclick="updateFilterSelection('body_part', 'body_part_examined_set','Body Part Examined','BodyPartExamined',true,false)">Not Available/Other</li>


                   </ul>
                </div>
            </div>



            <div id = "search_derived_set" align="left" style="display:none;">
               <div id="segmentation_heading">
                    <a role="button" data-toggle="collapse"  href="#segmentation" aria-expanded="false" aria-controls="segmentation" class="">
                   <i class="fa fa-caret-right"></i> Segmentation</a>
                </div>
                <div id="segmentation" class="collapse">
                    <ul style="list-style: none;">
                        <li>&emsp;<input type="checkbox" checked value="yes">&emsp;Segmentation Available</li>
                        <li>&emsp;<input type="checkbox" checked value="no">&emsp;Segmentation Not Available</li>
                    </ul>
                </div>

            </div>

            <div id = "search_related_set" align="left" style="display:none;">
                <div id="disease_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#disease" aria-expanded="false" aria-controls="disease">
                        <i class="fa fa-caret-right"></i> Disease Code</a>
                </div>

                <div id="disease" class="collapse">
                    <ul id="disease_list" style="list-style: none;">


                    </ul>
                </div>


                <div id="vital_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#vital" aria-expanded="false" aria-controls="vital">
                        <i class="fa fa-caret-right"></i> Vital Statistics</a>
                </div>

                <div id="vital" class="collapse">
                    <ul id="vital_list" style="list-style: none;">
                         <li>&emsp;<input type="checkbox" checked value="alive" onclick="updateFilterSelection('vital_list', 'vital_status_set','Vital Status','vital_status',false,false)">Alive</li>
                        <li>&emsp;<input type="checkbox" checked value="dead" onclick="updateFilterSelection('vital_list', 'vital_status_set','Vital Status','vital_status',false,false)">Dead</li>
                        <li>&emsp;<input type="checkbox" checked value="none" onclick="updateFilterSelection('vital_list', 'vital_status_set','Vital Status','vital_status',false,false)">NA</li>
                    </ul>
                </div>

                <div id="gender_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#gender" aria-expanded="false" aria-controls="vital">
                        <i class="fa fa-caret-right"></i>Gender</a>
                </div>

                <div id="gender" class="collapse">
                    <ul id="gender_list" style="list-style: none;">
                         <li>&emsp;<input type="checkbox" checked value="male" onclick="updateFilterSelection('gender_list', 'gender_set','Gender','gender',false,false)">Male</li>
                        <li>&emsp;<input type="checkbox" checked value="female" onclick="updateFilterSelection('gender_list', 'gender_set','Gender','gender',false,false)">Female</li>
                        <li>&emsp;<input type="checkbox" checked value="none" onclick="updateFilterSelection('gender_list', 'gender_set','Gender','gender',false,false)">NA</li>
                    </ul>
                </div>

               <div id="age_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#age" aria-expanded="false" aria-controls="age">
                        <i class="fa fa-caret-right"></i>Age</a>
                </div>

                <div id="age" class="collapse">
                    <ul id="age_list" style="list-style: none;">
                         <li>&emsp;<input type="checkbox" checked value="0,20" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">0-19</li>
                        <li>&emsp;<input type="checkbox" checked value="20,30" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">20-29</li>
                        <li>&emsp;<input type="checkbox" checked value="30,40" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">30-39</li>
                        <li>&emsp;<input type="checkbox" checked value="40,50" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">40-49</li>
                        <li>&emsp;<input type="checkbox" checked value="50,60" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">50-59</li>
                        <li>&emsp;<input type="checkbox" checked value="60,70" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">60-69</li>
                        <li>&emsp;<input type="checkbox" checked value="70,80" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">70-79</li>
                        <li>&emsp;<input type="checkbox" checked value="80" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">80 or Over</li>
                        <li>&emsp;<input type="checkbox" checked value="none" onclick="updateFilterSelection('age_list', 'age_set','Age','age',false,true)">NA</li>
                    </ul>
                </div>

                <div id="bmi_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#bmi" aria-expanded="false" aria-controls="bmi">
                        <i class="fa fa-caret-right"></i>BMI</a>
                </div>

                <div id="bmi" class="collapse">
                    <ul id="bmi_list" style="list-style: none;">
                         <li>&emsp;<input type="checkbox" checked value="0,18.5" onclick="updateFilterSelection('bmi_list', 'bmi_set','BMI','bmi',false,true)">Underweight: BMI less than 18.5</li>
                        <li>&emsp;<input type="checkbox" checked value="18.5,25" onclick="updateFilterSelection('bmi_list', 'bmi_set','BMI','bmi',false,true)">Normal weight: BMI greater than or equal to 18.5 and less than 25</li>
                        <li>&emsp;<input type="checkbox" checked value="25,30" onclick="updateFilterSelection('bmi_list', 'bmi_set','BMI','bmi',false,true)">Overweight: BMI greater than 25 and less than 30</li>
                        <li>&emsp;<input type="checkbox" checked value="30" onclick="updateFilterSelection('bmi_list', 'bmi_set','BMI','bmi',false,true)">Obese: BMI greater than 30</li>

                        <li>&emsp;<input type="checkbox" checked value="none">NA</li>
                    </ul>
                </div>

                <div id="race_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#race" aria-expanded="false" aria-controls="race">
                        <i class="fa fa-caret-right"></i>Race</a>
                </div>

                <div id="race" class="collapse">
                    <ul id="race_list" style="list-style: none;">
                    </ul>
                </div>

               <div id="ethnicity_heading" class="list-group-item__heading">
                    <a role="button" data-toggle="collapse"  href="#ethnicity" aria-expanded="false" aria-controls="ethnicity">
                        <i class="fa fa-caret-right"></i>Ethnicity</a>
                </div>

                <div id="ethnicity" class="collapse">
                    <ul id="ethnicity_list" style="list-style: none;">

                    </ul>
                </div>



            </div>

        </div>
       <div class="col-lg-12">
            <h3>Image Series Selection</h3>

            <p>Collection<select id="collection_select" onchange="updateSelections(0,[])">
            </select><br></p>

            <p>Patient<select id="patient_select" onchange="updateSelections(1,[])">
            </select><br></p>

            <p>Study<select id="study_select" onchange="updateSelections(2,[])"></select><br></p>

            <p>Series<select id="series_select">
            </select><br></p>

           <img ><br>
           <button onclick="window.open('/projects/chc-tcia/locations/us-central1/datasets/4d-lung/dicomStores/4d-lung/study/1.3.6.1.4.1.14519.5.2.1.6834.5010.173152375040663266298918385412','_blank')">Open Series in OHIF Viewer</button>


            <!-- <div id="viewId" style="position:relative;height:600px;width:500px">
                <h3><a target="_blank" href="localhost:8085/projects/chc-tcia/locations/us-central1/datasets/4d-lung/dicomStores/4d-lung/study/1.3.6.1.4.1.14519.5.2.1.6834.5010.173152375040663266298918385412">Open series in separate viewer</a></h3>
            -->
            <!-- <iframe id="srcU" style="height:500px;width:500px" src="http://localhost:8085/viewer/1.3.6.1.4.1.14519.5.2.1.6279.6001.265704884949271879044145982159"  loading="eager" onload="(function(){document.getElementById('srcU').contentWindow.scrollTo(2000,4000)})" ></iframe> -->

            <!--    <iframe id="srcU" style="height:500px;width:500px" src="http://localhost:8085/projects/chc-tcia/locations/us-central1/datasets/4d-lung/dicomStores/4d-lung/study/1.3.6.1.4.1.14519.5.2.1.6834.5010.173152375040663266298918385412"  loading="eager" onload="(function(){document.getElementById('srcU').contentWindow.scrollTo(2000,4000)})" ></iframe> -->

                <!-- <iframe> -->


              <!-- </iframe> -->

            </div>

    </div>
    <div class="col-lg-12" style="float:left;width:50%">
    <div style="width:100%"><h3>Search Results Summaries</h3></div>
        <div id = "results_orig" style="display:inline-block;width:32.8%;border: thin solid black;background-color:dodgerblue" onclick="toggleSearch(0,'results')"><h3>Original</h3></div>
        <div id = "results_derived" style="display:inline-block;width:32.8%;border: thin solid black" onclick="toggleSearch(1,'results')"><h3>Derived</h3></div>
        <div id = "results_related" style="display:inline-block;width:32.8%;border: thin solid black" onclick="toggleSearch(2,'results')"><h3>Related</h3></div>

        <div align="left"; style="width:100%;height:700px;display:inline-block;border: thin solid black;float:none">
            <div id = "results_orig_set" align="left" style="display:inline-block;height:600px">
            <div id="modality_chart" style="float:left;float:top display:inline-block;width:300px;height:200px" >
                <!-- <canvas id="modality_chart"   ></canvas> -->
            </div>
                <div id="body_part_examined_chart" style="float:left;float:top display:inline-block;width:300px;height:300px" >
                <!-- <canvas id="body_part_examined_chart"  ></canvas> -->
                </div>


            </div>
            <div id = "results_derived_set" align="left" style="display:none;"></div>
            <div id = "results_related_set" align="left" style="display:none;">

                 <div id="disease_code_chart" style="float:left;float:top display:inline-block;width:300px;height:200px" >
                <!-- <canvas id="disease_code_chart"   ></canvas> -->
            </div>
                <div id="vital_statistics_chart" style="float:left;float:top display:inline-block;width:300px;height:200px" >
                <!-- <canvas id="vital_statistics_chart"  ></canvas> -->
                </div>
                <div id="gender_chart" style="float:left;float:top display:inline-block;width:300px;height:200px" >
                <!-- <canvas id="gender_chart"  ></canvas> -->
                </div>
                <div id="age_chart" style="float:left;float:top display:inline-block;width:300px;height:200px" >
                <!-- <canvas id="gender_chart"  ></canvas> -->
                </div>

                <div id="race_chart" style="float:left;float:top display:inline-block;width:300px;height:200px" >
                <!-- <canvas id="race_chart"  ></canvas> -->
                </div>

                <div id="ethnicity_chart" style="float:left;float:top display:inline-block;width:300px;height:200px" >
                <!-- <canvas id="ethnicity_chart"  ></canvas> -->
                </div>

                    <!-- <div id="disease_code_plot" style="display-inline" ></div>
                <div id="vital_statistics_plot"></div> -->
               <!-- //style="width:A100%;display:inline-block;overflow-y:auto;overflow-x:auto" -->

            </div>

        </div>



        </div>



    </div>





{% endblock %}

{% block js_file %}{% static 'js/dashboard.js' %}{% endblock %}