{% extends 'base.html' %}
{% load static %}
{% load custom_tags %}
{% block title %}Cart | IDC{% endblock %}}
{% block extra_css_libs %}{% endblock %}
{% block header %}

    <link type="text/css" rel="stylesheet" href="{% static 'css/spinner.css' %}?v={{ APP_VERSION }}">
    <link type="text/css" rel="stylesheet" href="{% static 'css/cart.css' %}?v={{ APP_VERSION }}">
    <link type="text/css" rel="stylesheet" href="{% static 'css/jquery-ui.min.css' %}?v={{ APP_VERSION }}">

{% endblock %}

{% block link_page_name %}cart{% endblock %}
{% block page_name %}cart{% endblock %}

{% block page_header %}
<div class="container-fluid">
<div class="spinner" style="display: none;"><i class="fa-solid fa-spinner fa-spin spin"></i></div>
    <h3 class="pull-left">Cart - Study Level Summary</h3>
    <button class="btn btn-default  pull-right cart-reset" title="Empty the cart." onclick="window.resetCartPageView()"
    > Clear <i class="fa fa-solid fa-trash-can"></i>
    </button>
    <button class="btn btn-special pull-right cart-modal-button" data-toggle="modal"
        data-target="#cart-description-modal" title="Display this cart's filter and selections."
    > Definition <i class="fa fa-solid fa-magnifying-glass"></i>
    </button>
    <button class="btn pull-right btn-special citations-button filter-activated-controls for-cart" data-toggle="modal" data-target="#citations-modal" role="button"
        title="Display the cart's citation list in Vancouver format."
    > Citations <i class="smaller-icon fa fa-quote-left"></i><i class="smaller-icon fa fa-quote-right"></i>
    </button>
    <div class="dropdown cart-download-menu-container pull-right"
        title="Select a filter to enable this feature."
         data-default-title="Save this cart's image files."
         disabled="disabled"
    >
        <a class="dropdown-toggle btnGroupDropViewers cart-download-menu-toggle download-toggle btn btn-special pull-right"
           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
           title="Save this cart's image files."
        >
            Download <i class="fa-solid fa-download"></i>
        </a>
        <ul class="dropdown-menu cart-download-menu no-pull" role="menu">
            <li>
                <a id="export-manifest-cart" class="export-cart-manifest cart-export-from-cp" data-toggle="modal"
                    title="Export this cart's series as a manifest for download."
                    data-target="#export-manifest-modal"
                ><i class="fa fa-solid fa-list"></i> Manifest
                </a>
            </li>
            <li>
                <span id="download-cart-images-tooltips" class="download-instances is-disabled"
                      data-download-type="cart" data-disabled-type="download-cart-disabled">
                    <a id="download-cart-images" class="download-all-instances download-menu-item tip-titled"
                        data-download-type="cart"
                    ><i class="fa fa-solid fa-save"></i> Save
                    </a>
                </span>
            </li>
        </ul>
    </div>
</div>
{% endblock %}
{% block content %}
<div class="container-fluid">
    <div class ="row">
        <div class="col-lg-12 col-md-12 collex-panel">
            <div class="cart-wrapper panel panel-default short-inner-content" role="panel panel-default" id="cart-list">
                <div class="panel-body">
                    <div id="stats"> {{ stats }}</div>
                <table id="cart-table" class="table collex-table sortable_table table-striped table-hover">
                    <thead id ="cart-head">

                        <!-- <th class="del">Remove</th> -->
                        <th class="projid">Project ID</th>
                        <th class="caseid">Case ID</th>
                        <th class="studyid">StudyInstanceUID</th>
                        <th>Number of Series in Cart</th>
                        <th class="viewer">View</th>

                    </thead>
                    <colgroup>
                       <!-- <col style="width: 10%"> -->
                        <col style="width: 20%">
                        <col style="width: 20%">
                        <col style="width: 20%">
                        <col style="width: 15%">
                        <col style="width: 15%">

                    </colgroup>
                    <tbody id="cart-body">

                    </tbody>
                </table>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Include footer here instead of base.html so it can be hidden by default -->
{% include 'share/site_footer.html' with hide="False" %}
{% include "idc/cart-details-modal.html" %}

{% url 'get_explore_manifest' as export_uri %}


{% endblock %}


{% block js_file %}

    {{ carthist|json_script:"carthist" }}
    {{ mxstudies|json_script:"mxstudies" }}
    {{ mxseries|json_script:"mxseries" }}
    {{ cart_disk_size|json_script:"cart_disk_size" }}
	{{ block.super }}
    <script type="text/javascript" src="{% static 'js/cart_page.js' %}?v={{ APP_VERSION }}"></script>
    <script type="text/javascript" src="{% static 'js/cohorts/export-manifest.js' %}?v={{ APP_VERSION }}"></script>
    <script type="text/javascript" src="{% static 'js/citations_modal.js' %}?v={{ APP_VERSION }}"></script>
    <script type="text/javascript" src="{% static 'js/tooltips.js' %}?v={{ APP_VERSION }}"></script>
{% endblock %}

{% block modal_includes %}
    {% include "idc/citations-modal.html" %}
    {% include "cohorts/cart-description-modal.html" %}
    {% include "cohorts/export-manifest-modal.html" %}
    {% include "idc/download-modal.html" %}
{% endblock %}